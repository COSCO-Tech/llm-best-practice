{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u4e2d\u8fdc\u6d77\u8fd0\u79d1\u6280\u5927\u6a21\u578b\u6700\u4f73\u5b9e\u8df5\u6587\u6863","text":"<p>Hi-Dolphin \u56fd\u5185\u9996\u4e2a\u822a\u8fd0\u5927\u6a21\u578b</p>"},{"location":"NPU/docker/","title":"\u56fd\u4ea7\u94f6\u6cb3\u9e92\u9e9fV10\u7cfb\u7edf aarch64\u67b6\u6784 \u79bb\u7ebf\u5b89\u88c5Docker","text":"<ol> <li> <p>\u4fe1\u606f\u786e\u8ba4</p> <ul> <li> <p>\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c</p> bash input<pre><code>uname -a\n</code></pre> bash output example<pre><code>Linux localhost.localdomain 4.19.90-24.4.v2101.ky10.aarch64 #1 SMP Mon May 24 14:45:37 CST 2021 aarch64 aarch64 aarch64 GNU/Linux\n</code></pre> </li> <li> <p>\u64cd\u4f5c\u7cfb\u7edf\u67b6\u6784</p> bash input<pre><code>uname -m\n</code></pre> bash output example<pre><code>aarch64\n</code></pre> </li> </ul> </li> <li> <p>\u4e0b\u8f7dDocker \u548c Docker-Compose</p> <p>2.1 \u79bb\u7ebf\u4e0b\u8f7dDocker\u5b89\u88c5\u5305 \u4e0b\u8f7d\u5b8c\u6210\u540e \u901a\u8fc7\u5185\u7f51\u4f20\u8f93\u81f3\u670d\u52a1\u5668\u5185 </p> <ul> <li>Docker Linux \u7a33\u5b9a\u7248\u672c\u4e0b\u8f7d\u5730\u5740</li> </ul> <p>\u4ee5\u8be5\u673a\u5668\u4e3a\u4f8b\uff1a\u53ef\u76f4\u63a5\u70b9\u51fb\u8be5\u94fe\u63a5\u8fdb\u884c\u4e0b\u8f7daarch64\u67b6\u6784\u7684docker27.0.2\u7248\u672c\uff1a</p> <ul> <li>aarch64/docker-27.0.2.tgz</li> </ul> <p>2.2 \u79bb\u7ebf\u4e0b\u8f7dDocker-Compose\u5b89\u88c5\u5305</p> <ul> <li>Docker Compose Github Releases</li> </ul> <p>\u4ee5\u8be5\u673a\u5668\u4e3a\u4f8b\uff1a\u53ef\u76f4\u63a5\u70b9\u51fb\u8be5\u94fe\u63a5\u8fdb\u884c\u4e0b\u8f7daarch64\u67b6\u6784\u7684docker27.0.2\u7248\u672c\uff1a</p> <ul> <li>docker-compose-linux-aarch64</li> </ul> </li> <li> <p>\u5b89\u88c5Docker \u548c Docker-Compose</p> <ul> <li> <p>\u89e3\u538bDocker\u5b89\u88c5\u5305</p> bash input<pre><code>tar -xvf docker-27.0.2.tgz\n</code></pre> </li> <li> <p>\u5236\u4f5cdocker.service\u6587\u4ef6</p> bash input<pre><code>cat &gt; docker.service &lt;&lt;EOF\ndocker.service\n\n[Unit]\nDescription=Docker Application Container Engine\nDocumentation=https://docs.docker.com\nAfter=network-online.target firewalld.service\nWants=network-online.target\n\n[Service]\nType=notify\n# the default is not to use systemd for cgroups because the delegate issues still\n# exists and systemd currently does not support the cgroup feature set required\n# for containers run by docker\nExecStart=/usr/bin/dockerd\nExecReload=/bin/kill -s HUP $MAINPID\n# Having non-zero Limit*s causes performance problems due to accounting overhead\n# in the kernel. We recommend using cgroups to do container-local accounting.\nLimitNOFILE=infinity\nLimitNPROC=infinity\nLimitCORE=infinity\n# Uncomment TasksMax if your systemd version supports it.\n# Only systemd 226 and above support this version.\n#TasksMax=infinity\nTimeoutStartSec=0\n# set delegate yes so that systemd does not reset the cgroups of docker containers\nDelegate=yes\n# kill only the docker process, not all processes in the cgroup\nKillMode=process\n# restart the docker process if it exits prematurely\nRestart=on-failure\nStartLimitBurst=3\nStartLimitInterval=60s\n\n[Install]\nWantedBy=multi-user.target\nEOF\n</code></pre> </li> <li> <p>\u590d\u5236Docker\u6587\u4ef6\u5939\u81f3/usr/bin\u76ee\u5f55\u4e0b</p> bash input<pre><code>cp -a docker/* /usr/bin/\n</code></pre> </li> <li> <p>\u5c06docker-compose\u6587\u4ef6\u590d\u5236\u5230/usr/local/bin/\u76ee\u5f55\u4e0b</p> bash input<pre><code>cp docker-compose-linux-aarch64 /usr/local/bin/docker-compose\n</code></pre> </li> <li> <p>\u6dfb\u52a0\u6267\u884c\u6743\u9650</p> bash input<pre><code>chmod +x /usr/local/bin/docker-compose\n</code></pre> </li> <li> <p>\u5c06 docker.service \u79fb\u5230 /etc/systemd/system/ \u76ee\u5f55</p> bash input<pre><code>cp docker.service /etc/systemd/system/\n</code></pre> </li> <li> <p>\u8bbe\u7f6edocker.service\u6587\u4ef6\u6743\u9650</p> bash input<pre><code>chmod +x /etc/systemd/system/docker.service\n</code></pre> </li> <li> <p>\u91cd\u8f7d\u914d\u7f6e\u6587\u4ef6</p> bash input<pre><code>systemctl daemon-reload\n</code></pre> </li> <li> <p>\u542f\u52a8docker\u670d\u52a1</p> bash input<pre><code>systemctl start docker\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f</p> bash input<pre><code>systemctl enable docker.service\n</code></pre> bash output<pre><code>Created symlink /etc/systemd/system/multi-user.target.wants/docker.service \u2192 /etc/systemd/system/docker.service.\n</code></pre> </li> <li> <p>\u9a8c\u8bc1docker\u662f\u5426\u5b89\u88c5\u6210\u529f</p> bash input<pre><code>docker --version\n</code></pre> bash output<pre><code>Docker version 27.0.2, build 912c1dd\n</code></pre> </li> <li> <p>\u9a8c\u8bc1docker-compose\u662f\u5426\u5b89\u88c5\u6210\u529f</p> bash input<pre><code>docker-compose --version\n</code></pre> bash output<pre><code>Docker Compose version v2.29.1\n</code></pre> </li> </ul> </li> <li> <p>Docker \u955c\u50cf\u52a0\u901f</p> <ul> <li> <p>\u7f16\u8f91 /etc/docker/daemon.json \u6587\u4ef6</p> bash input<pre><code>mkdir -p /etc/docker\ncat &gt; /etc/docker/daemon.json &lt;&lt;EOF\n{\n    \"registry-mirrors\": [\"https://dockerhub.icu\"]\n}\nEOF\n</code></pre> </li> <li> <p>\u91cd\u542fdocker\u670d\u52a1</p> bash input<pre><code>systemctl restart docker\n</code></pre> </li> <li> <p>\u6d4b\u8bd5\u955c\u50cf\u52a0\u901f\u662f\u5426\u751f\u6548</p> bash input<pre><code>docker info\n</code></pre> bash output<pre><code>...\nRegistry Mirrors:\n https://dockerhub.icu/\n...\n</code></pre> </li> </ul> </li> </ol>"},{"location":"NPU/env/","title":"Atlas 300I Duo NPU\u9a71\u52a8\u548c\u56fa\u4ef6\u5b89\u88c5","text":""},{"location":"NPU/env/#_1","title":"\u51c6\u5907","text":"<ol> <li> <p>\u786e\u8ba4\u64cd\u4f5c\u7cfb\u7edf</p> <p>\u67e5\u8be2\u670d\u52a1\u5668\u53ca\u914d\u5957PCIe\u5361\u652f\u6301\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u8be6\u7ec6\u8bf7\u53c2\u8003\u8ba1\u7b97\u4ea7\u54c1\u517c\u5bb9\u6027\u67e5\u8be2\u52a9\u624b\u3002</p> bash input<pre><code>uname -m &amp;&amp; cat /etc/*release\n</code></pre> bash output example<pre><code>aarch64\nKylin Linux Advanced Server release V10 (Sword)\nDISTRIB_ID=Kylin\nDISTRIB_RELEASE=V10\nDISTRIB_CODENAME=juniper\nDISTRIB_DESCRIPTION=\"Kylin V10\"\nDISTRIB_KYLIN_RELEASE=V10\nDISTRIB_VERSION_TYPE=enterprise\nDISTRIB_VERSION_MODE=normal\nNAME=\"Kylin Linux Advanced Server\"\nVERSION=\"V10 (Sword)\"\nID=\"kylin\"\nVERSION_ID=\"V10\"\nPRETTY_NAME=\"Kylin Linux Advanced Server V10 (Sword)\"\nANSI_COLOR=\"0;31\"\n\nKylin Linux Advanced Server release V10 (Sword)\n</code></pre> </li> <li> <p>\u83b7\u53d6\u8f6f\u4ef6\u5305\u548c\u914d\u5957\u8868</p> <ul> <li> <p>\u56fa\u4ef6\u4e0e\u9a71\u52a8\u5b89\u88c5\u5305</p> <ul> <li>\u4ea7\u54c1\u578b\u53f7: Atlas 300I Duo \u63a8\u7406\u5361</li> <li>CANN\u7248\u672c: 8.0.RC3.alpha001</li> <li>\u56fa\u4ef6\u4e0e\u9a71\u52a8: 1.0.22.alpha</li> <li>\u8f6f\u4ef6\u5305\u683c\u5f0f: run</li> <li>\u7ec4\u4ef6: NPU</li> <li>CPU\u67b6\u6784: AArch64</li> </ul> </li> <li> <p>\u56fa\u4ef6\u4e0e\u9a71\u52a8\u5b89\u88c5\u6307\u5bfc</p> </li> </ul> </li> <li> <p>\u6821\u9a8c\u5b89\u88c5\u5305\uff1a</p> <pre><code>chmod a+x Ascend-hdk-310p-npu-driver_23.0.1_linux-aarch64.run\nchmod a+x Ascend-hdk-310p-npu-firmware_7.1.0.4.220.run\n./Ascend-hdk-310p-npu-driver_23.0.1_linux-aarch64.run --check  # \u6821\u9a8crun\u5b89\u88c5\u5305\u7684\u4e00\u81f4\u6027\u548c\u5b8c\u6574\u6027\u3002\n./Ascend-hdk-310p-npu-firmware_7.1.0.4.220.run --check\n</code></pre> <p>\u51fa\u73b0\u5982\u4e0b\u56de\u663e\u4fe1\u606f\uff0c\u8868\u793a\u8f6f\u4ef6\u5305\u6821\u9a8c\u6210\u529f\u3002</p> <pre><code>Verifying archive integrity...  100%   SHA256 checksums are OK. All good.\n</code></pre> </li> <li> <p>\u521b\u5efa\u7528\u6237</p> <pre><code>groupadd HwHiAiUser\nuseradd -g HwHiAiUser -d /home/HwHiAiUser -m HwHiAiUser -s /bin/bash\npassword HwHiAiUser  # \u8bbe\u7f6e\u5bc6\u7801\n</code></pre> </li> <li> <p>\u5b89\u88c5</p> <pre><code>./Ascend-hdk-310p-npu-driver_23.0.1_linux-aarch64.run --full --install-for-all\n./Ascend-hdk-310p-npu-firmware_7.1.0.4.220.run --full\n</code></pre> </li> <li> <p>\u7ed3\u8bba</p> <p>\u786e\u8ba4\u5b89\u88c5\u6210\u529f</p> <pre><code>npu-smi info\n</code></pre> <p>\u8fd4\u56de\u4fe1\u606f\u91cd\u5199\u540e\u5982\u4e0b</p> <p>Atlas 300I Duo \u6bcf\u5f20\u5361\u5185\u67092\u5f20\u82af\u7247 \u6bcf\u5f20\u82af\u7247\u7684\u663e\u5b58\u4e3a48GB \u5b9e\u9645\u663e\u5b58\u5927\u5c0f\u7ea6\u4e3a44GB\u5de6\u53f3</p> NPU Name Health Power(W) Temp(C) Hugepages-Usage(page) Chip Device Bus-Id AICore(%) Memory-Usage(MB) 1 310P3 OK NA 54 0 / 0 0 0 0000:01:00.0 0 1611 / 44216 1 310P3 OK NA 56 0 / 0 1 1 0000:01:00.0 0 1225 / 43757 2 310P3 OK NA 58 0 / 0 0 2 0000:02:00.0 0 1616 / 44216 2 310P3 OK NA 57 0 / 0 1 3 0000:02:00.0 0 1229 / 43757 4 310P3 OK NA 57 0 / 0 0 4 0000:81:00.0 0 1849 / 44216 4 310P3 OK NA 57 0 / 0 1 5 0000:81:00.0 0 997 / 43757 5 310P3 OK NA 58 0 / 0 0 6 0000:82:00.0 0 1423 / 44216 5 310P3 OK NA 57 0 / 0 1 7 0000:82:00.0 0 1422 / 43757 </li> </ol>"},{"location":"NPU/llm/","title":"Atlas 300I Duo MindIE\u6a21\u578b\u63a8\u7406","text":"<p>Atlas 300I Duo\u662f\u534e\u4e3a\u63a8\u7406\u5361\uff0c\u652f\u6301MindIE\u6a21\u578b\u63a8\u7406\u3002\u672c\u6587\u4ecb\u7ecd\u5982\u4f55\u5728Atlas 300I Duo\u4e0a\u8fdb\u884cMindIE\u6a21\u578b\u63a8\u7406\u3002</p>"},{"location":"NPU/llm/#_1","title":"\u73af\u5883\u51c6\u5907","text":"<ul> <li> <p>\u7269\u7406\u673a\u5df2\u5b89\u88c5Docker\uff0c\u4e14Docker\u7f51\u7edc\u53ef\u7528</p> <pre><code>docker --version\n</code></pre> </li> <li> <p>\u9a8c\u8bc1Docker\u7f51\u7edc</p> <pre><code># \u521b\u5efa\u6d4b\u8bd5\u7528Docker\u5bb9\u5668\ndocker run -it --rm alpine /bin/sh\n\n# \u5728\u5bb9\u5668\u4e2d\u6267\u884c\u7f51\u7edc\u8fde\u901a\u6027\u6d4b\u8bd5\nping -c 3 www.baidu.com\n\n# \u68c0\u67e5\u7f51\u7edc\u8fde\u901a\u6027\u6d4b\u8bd5\u7ed3\u679c ping \u547d\u4ee4\u7684\u8fd4\u56de\u503c\u4e3a0\u8868\u793a\u7f51\u7edc\u8fde\u901a\uff0c\u975e0\u8868\u793a\u7f51\u7edc\u4e0d\u901a\u3002\necho $?\n</code></pre> </li> </ul>"},{"location":"NPU/miniforge/","title":"Atlas 300I Duo \u79bb\u7ebf\u5b89\u88c5Miniforge Python\u73af\u5883","text":"<p>\u7531\u4e8e\u4f17\u6240\u5468\u77e5\u7684\u539f\u56e0\uff0c\u907f\u514d\u4f7f\u7528miniconda\uff0c\u6545\u9009\u62e9miniforge\u4f5c\u4e3a\u5f00\u6e90\u66ff\u4ee3\u65b9\u6848</p> <ul> <li> <p>\u68c0\u67e5\u672c\u673a\u67b6\u6784</p> bash input<pre><code>uname -m\n</code></pre> bash output example<pre><code>aarch64\n</code></pre> </li> <li> <p>\u4e0b\u8f7dminiforge</p> <p>Miniforge3-Linux-aarch64</p> <p>\u901a\u8fc7\u5185\u7f51\u4f20\u8f93\u81f3\u670d\u52a1\u5668\u5185</p> </li> <li> <p>\u5b89\u88c5miniforge </p> bash input<pre><code>bash Miniforge3-Linux-aarch64.sh\n\nEnter &gt; yes &gt; Enter &gt; Enter\n</code></pre> </li> <li> <p>\u914d\u7f6eminiforge\u73af\u5883\u53d8\u91cf</p> bash input<pre><code>echo 'export PATH=\"/root/miniforge3/bin:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nconda init\nsource ~/.bashrc\n</code></pre> </li> <li> <p>\u9a8c\u8bc1miniforge\u5b89\u88c5</p> bash input<pre><code>conda --version\n</code></pre> bash output example<pre><code>conda 24.3.0\n</code></pre> </li> <li> <p>\u6d4b\u8bd5pip</p> bash input<pre><code>pip --version\n</code></pre> bash output example<pre><code>pip 24.0 from /root/miniforge3/lib/python3.10/site-packages/pip (python 3.10)\n</code></pre> </li> <li> <p>\u6d4b\u8bd5python</p> bash input<pre><code>python\n</code></pre> bash output example<pre><code>Python 3.10.14 | packaged by conda-forge | (main, Mar 20 2024, 21:44:20) [GCC 12.3.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; \n</code></pre> </li> <li> <p>\u514b\u9686base\u73af\u5883\u4ee5\u521b\u5efa\u65b0\u7684\u865a\u62df\u73af\u5883</p> <pre><code>```bash title='bash input'\nconda create -n infer --clone base\n```\n</code></pre> </li> </ul>"},{"location":"NPU/vnpu/","title":"Atlas 300I Duo \u6607\u817e\u865a\u62df\u5316\u5b9e\u4f8b\uff08\u7b97\u529b\u5207\u5206\uff09","text":"<p>\u524d\u63d0\uff1a</p> <ul> <li>\u5df2\u7ecf\u5b8c\u6210\u6607\u817eNPU\u9a71\u52a8\u56fa\u4ef6\u5b89\u88c5\uff0c\u9a71\u52a8\u5b89\u88c5\u540e\uff0c\u7528\u6237\u5c31\u80fd\u4f7f\u7528\u865a\u62df\u5316\u5b9e\u4f8b\u529f\u80fd</li> </ul>"},{"location":"NPU/vnpu/#vnpu","title":"\u521b\u5efavNPU","text":"<p>npu-smi set -t create-vnpu -i id -c chip_id -f vnpu_config [-v vnpu_id] [-g vgroup_id]</p> <ul> <li>id: \u8bbe\u5907id\u3002\u901a\u8fc7npu-smi info -l\u547d\u4ee4\u67e5\u51fa\u7684NPU ID\u5373\u4e3a\u8bbe\u5907id\u3002</li> <li>chip_id: \u82af\u7247id\u3002\u901a\u8fc7npu-smi info -m\u547d\u4ee4\u67e5\u51fa\u7684Chip ID\u5373\u4e3a\u82af\u7247id\u3002</li> <li>vnpu_config: \u7b97\u529b\u5207\u5206\u6a21\u677f\u540d\u79f0\uff0c\u53ef\u53c2\u89c1\u88682</li> <li>vnpu_id: \u6307\u5b9a\u9700\u8981\u521b\u5efa\u7684vNPU\u7684id\u3002<ul> <li>\u9996\u6b21\u521b\u5efa\u53ef\u4ee5\u4e0d\u6307\u5b9a\u8be5\u53c2\u6570\uff0c\u7531\u7cfb\u7edf\u9ed8\u8ba4\u5206\u914d\u3002\u82e5\u91cd\u542f\u540e\u4e1a\u52a1\u9700\u8981\u4f7f\u7528\u91cd\u542f\u524d\u7684vnpu_id\uff0c\u53ef\u4ee5\u4f7f\u7528-v\u53c2\u6570\u6307\u5b9a\u91cd\u542f\u524d\u7684vnpu_id\u8fdb\u884c\u6062\u590d\u3002</li> <li>\u53d6\u503c\u8303\u56f4\u3002<ul> <li>Ascend 310P\u7684vnpu_id\u7684\u53d6\u503c\u8303\u56f4\u4e3a[phy_id*16 + 100, phy_id * 16+107]\u3002</li> <li>Ascend 910\u7684vnpu_id\u7684\u53d6\u503c\u8303\u56f4\u4e3a[phy_id*16 + 100, phy_id * 16+115]\u3002<ul> <li>Tips: phy_id\u8868\u793a\u82af\u7247\u7269\u7406ID\uff0c\u53ef\u901a\u8fc7\u6267\u884cls /dev/davinci*\u547d\u4ee4\u83b7\u53d6\u82af\u7247\u7684\u7269\u7406ID\u3002\u4f8b\u5982/dev/davinci0\uff0c\u8868\u793a\u82af\u7247\u7684\u7269\u7406ID\u4e3a0\u3002</li> </ul> </li> <li>vnpu_id\u4f20\u51654294967295\u65f6\u8868\u793a\u4e0d\u6307\u5b9a\u865a\u62df\u8bbe\u5907\u53f7\u3002</li> <li>\u540c\u4e00\u8bbe\u5907\u5185\u4e0d\u53ef\u91cd\u590d\u521b\u5efa\u76f8\u540cvnpu_id\u7684vNPU\u3002</li> </ul> </li> </ul> </li> <li>vgroup_id: \u865a\u62df\u8d44\u6e90\u7ec4vGroup\u7684id\uff0c\u53d6\u503c\u8303\u56f40~3\u3002vGroup\u7684\u6982\u5ff5\u53ef\u4ee5\u53c2\u89c1\u865a\u62df\u5316\u6a21\u5f0f\uff0c\u4ec5Ascend 310P\u652f\u6301\u672c\u53c2\u6570\u3002</li> </ul>"},{"location":"NPU/vnpu/#_1","title":"\u53c2\u6570\u67e5\u770b","text":"<ul> <li> <p>\u67e5\u627e<code>id</code> bash input<pre><code>npu-smi info -l\n</code></pre></p> <p>\u6b64\u5904\u6211\u9009\u62e9NPU ID\u4e3a5\u7684\u8bbe\u5907\u8fdb\u884c\u64cd\u4f5c</p> </li> <li> <p>\u67e5\u627e<code>chip_id</code> bash input<pre><code>npu-smi info -m\n</code></pre></p> <p>\u6b64\u5904\u6211\u9009\u62e9Chip ID\u4e3a1\u7684\u82af\u7247\u8fdb\u884c\u64cd\u4f5c</p> </li> <li> <p>\u7b97\u529b\u5207\u5206\u6a21\u677f <code>vnpu_config</code></p> <p>\u6b64\u5904\u6211\u9009\u62e9 vir04 \u865a\u62df\u5316\u5b9e\u4f8b\u6a21\u677f</p> </li> </ul>"},{"location":"NPU/vnpu/#_2","title":"\u4f7f\u7528\u793a\u4f8b","text":"<ul> <li> <p>\u5728\u8bbe\u59075\u4e2d\u7f16\u53f7\u4e3a1\u7684\u82af\u7247\u4e0a\u6839\u636e\u6a21\u677fvir04\u521b\u5efavNPU\u3002</p> bash input<pre><code>npu-smi set -t create-vnpu -i 5 -c 1 -f vir04\n</code></pre> bash output example<pre><code>    Status                         : OK\n    Message                        : Create vnpu success\n</code></pre> </li> <li> <p>\u914d\u7f6evNPU\u6062\u590d\u72b6\u6001\u3002\u8be5\u53c2\u6570\u7528\u4e8e\u8bbe\u5907\u91cd\u542f\u65f6\uff0c\u8bbe\u5907\u80fd\u591f\u4fdd\u5b58vNPU\u914d\u7f6e\u4fe1\u606f\uff0c\u91cd\u542f\u540e\uff0cvNPU\u914d\u7f6e\u4f9d\u7136\u6709\u6548\u3002</p> <p>\u547d\u4ee4\u683c\u5f0f\uff1a<code>npu-smi set -t vnpu-cfg-recover -d mode</code></p> <p>mode\u8868\u793avNPU\u7684\u914d\u7f6e\u6062\u590d\u4f7f\u80fd\u72b6\u6001\uff0c\u201c1\u201d\u8868\u793a\u5f00\u542f\u72b6\u6001\uff0c\u201c0\u201d\u8868\u793a\u5173\u95ed\u72b6\u6001\uff0c\u9ed8\u8ba4\u4e3a\u4f7f\u80fd\u72b6\u6001\u3002</p> <p>\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u8bbe\u7f6evNPU\u7684\u914d\u7f6e\u6062\u590d\u72b6\u6001\uff0c\u4ee5\u4e0b\u547d\u4ee4\u8868\u793a\u5c06vNPU\u7684\u914d\u7f6e\u6062\u590d\u72b6\u6001\u8bbe\u7f6e\u4e3a\u4f7f\u80fd\u72b6\u6001\u3002</p> bash input<pre><code>npu-smi set -t vnpu-cfg-recover -d 1\n</code></pre> bash output example<pre><code>    Status                         : OK\n    Message                        : The VNPU config recover mode Enable is set successfully.\n</code></pre> </li> <li> <p>\u67e5\u8be2vNPU\u7684\u914d\u7f6e\u6062\u590d\u72b6\u6001\u3002</p> <p>\u4ee5\u4e0b\u547d\u4ee4\u8868\u793a\u67e5\u8be2\u5f53\u524d\u73af\u5883\u4e2dvNPU\u7684\u914d\u7f6e\u6062\u590d\u4f7f\u80fd\u72b6\u6001\u3002</p> bash input<pre><code>npu-smi info -t vnpu-cfg-recover\n</code></pre> </li> <li> <p>\u67e5\u8be2vNPU\u4fe1\u606f</p> <p>\u547d\u4ee4\u683c\u5f0f\uff1anpu-smi info -t info-vnpu -i id -c chip_id</p> <ul> <li>id: \u8bbe\u5907id\u3002\u901a\u8fc7npu-smi info -l\u547d\u4ee4\u67e5\u51fa\u7684NPU ID\u5373\u4e3a\u8bbe\u5907id\u3002</li> <li>chip_id: \u82af\u7247id\u3002\u901a\u8fc7npu-smi info -m\u547d\u4ee4\u67e5\u51fa\u7684Chip ID\u5373\u4e3a\u82af\u7247id\u3002</li> </ul> bash input<pre><code>npu-smi info -t info-vnpu -i 5 -c 1\n</code></pre> bash output example<pre><code>Format:Free/Total                   NA: Currently, query is not supported.    |\n AICORE    Memory    AICPU    VPC    VENC    VDEC    JPEGD    JPEGE    PNGD    |\n            GB\n 4/8       21/42     3/7      6/12   1/3     6/12    8/16     4/8      NA/NA\nTotal number of vnpu: 1 \nVnpu ID  |  Vgroup ID     |  Container ID  |  Status  |  Template Name\n212      |  0             |  000000000000  |  0       |  vir04\n</code></pre> <p>\u4ecd\u67094AICORE\u7a7a\u95f2 21GB\u5185\u5b58\u7a7a\u95f2 3AICPU\u7a7a\u95f2 6\u6838\u5fc3VPC\u7a7a\u95f2 1\u6838\u5fc3VENC\u7a7a\u95f2 6\u6838\u5fc3VDEC\u7a7a\u95f2 8\u6838\u5fc3JPEGD\u7a7a\u95f2 4\u6838\u5fc3JPEGE\u7a7a\u95f2 \u6545\u53ef\u7ee7\u7eed\u5207\u5206</p> </li> </ul>"},{"location":"NPU/vnpu/#_3","title":"\u7ee7\u7eed\u5207\u5206","text":"<ul> <li> <p>\u865a\u62df\u5316\u5b9e\u4f8b\u7ec4\u5408</p> </li> <li> <p>\u9009\u62e9 vir04 + vir02_1c + vir01 + vir01 \u7684\u865a\u62df\u5316\u7ec4\u5408 \u7ee7\u7eed\u8fdb\u884c\u5207\u5206</p> bash input<pre><code>npu-smi set -t create-vnpu -i 5 -c 1 -f vir02_1c\nnpu-smi set -t create-vnpu -i 5 -c 1 -f vir01\nnpu-smi set -t create-vnpu -i 5 -c 1 -f vir01\n</code></pre> </li> <li> <p>\u67e5\u8be2vNPU\u4fe1\u606f</p> bash input<pre><code>npu-smi info -t info-vnpu -i 5 -c 1\n</code></pre> </li> <li> <p>\u6574\u7406\u540e\u7684vNPU\u4fe1\u606f</p> \u8d44\u6e90\u7c7b\u578b \u7a7a\u95f2/\u603b\u6570 \u8bf4\u660e AICORE 0/8 AI\u6838\u5fc3\u8d44\u6e90 Memory 0/42 \u5185\u5b58\u8d44\u6e90\uff08GB\uff09 AICPU 0/7 AI CPU\u8d44\u6e90 VPC 1/12 \u89c6\u9891\u5904\u7406\u5355\u5143 VENC 1/3 \u89c6\u9891\u7f16\u7801\u5355\u5143 VDEC 1/12 \u89c6\u9891\u89e3\u7801\u5355\u5143 JPEGD 0/16 JPEG\u89e3\u7801\u5355\u5143 JPEGE 0/8 JPEG\u7f16\u7801\u5355\u5143 PNGD NA/NA PNG\u89e3\u7801\u5355\u5143\uff08\u4e0d\u652f\u6301\u67e5\u8be2\uff09 Vnpu ID Vgroup ID Container ID Status Template Name 212 0 000000000000 0 vir04 213 1 000000000000 0 vir02_1c 214 2 000000000000 0 vir01 215 2 000000000000 0 vir01 </li> <li> <p>\u9500\u6bc1\u6307\u5b9avNPU</p> <p>\u547d\u4ee4\u683c\u5f0f\uff1anpu-smi set -t destroy-vnpu -i id -c chip_id -v vnpu_id</p> bash input<pre><code>npu-smi set -t destroy-vnpu -i 5 -c 1 -v 213\n</code></pre> <p>\u663e\u793a\u5982\u4e0b\u4fe1\u606f\u8868\u793a\u9500\u6bc1\u6210\u529f bash output example<pre><code>    Status                         : OK\n    Message                        : Destroy vnpu 213 success\n</code></pre></p> </li> </ul>"},{"location":"NPU/vnpu/#dockervnpu","title":"\u539f\u751fDocker\u4f7f\u7528vNPU","text":"<ul> <li> <p>\u4f7f\u7528\u65b9\u6cd5</p> <ul> <li> <p>\u67e5\u770bvNPU\u8bbe\u5907\u540d\u79f0</p> bash input<pre><code>ls /dev/ | grep davinci*\n</code></pre> <p>\u6b64\u5904\u6211\u9009\u62e9 <code>vdavinci213</code> \u8fdb\u884c\u64cd\u4f5c</p> </li> <li> <p>\u62c9\u8d77\u5bb9\u5668\u65f6\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5c06vNPU\u6302\u8f7d\u81f3\u5bb9\u5668\u4e2d</p> bash input<pre><code>docker run -it \\\n--device=/dev/vdavinci213:/dev/davinci213 \\\n--device=/dev/davinci_manager \\\n--device=/dev/devmm_svm \\\n--device=/dev/hisi_hdc \\\n-v /usr/local/bin/npu-smi:/usr/local/bin/npu-smi \\\n-v /home:/home \\\n-v /usr/local/Ascend/driver/lib64/common:/usr/local/Ascend/driver/lib64/common \\\n-v /usr/local/Ascend/driver/lib64/driver:/usr/local/Ascend/driver/lib64/driver \\\n-v /etc/ascend_install.info:/etc/ascend_install.info \\\n-v /usr/local/Ascend/driver/version.info:/usr/local/Ascend/driver/version.info \\\ndocker_image_id  /bin/bash\n</code></pre> </li> <li> <p>\u5bb9\u5668\u542f\u52a8\u4e4b\u540e\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u5f53\u524dDocker\u5bb9\u5668\u4e2d\u53ef\u4ee5\u4f7f\u7528\u7684davinci\u8bbe\u5907\uff0c\u5982\u679c\u6709davinci\u8bbe\u5907\u5219\u8868\u793a\u865a\u62df\u8bbe\u5907\u6210\u529f\u6620\u5c04\u5230\u5bb9\u5668\u4e2d\u3002</p> bash input<pre><code>ls /dev/ | grep davinci*\n</code></pre> <p>\u5982\u679c\u6709 <code>davinci213</code> \u8868\u660e\u865a\u62df\u8bbe\u5907\u6620\u5c04\u6210\u529f</p> </li> </ul> </li> </ul>"}]}